import{g as q,d as R,r as S,o as z,a as B,c as A,e as T,f as k,w as b,u as D,n as H,h as C,b as P,i as V,p as O,j as G,E as J,_ as K}from"./index-BuBiKJaM.js";var F={exports:{}};/*!
  * $script.js JS loader & dependency manager
  * https://github.com/ded/script.js
  * (c) Dustin Diaz 2014 | License MIT
  */(function(f){(function(y,r){f.exports?f.exports=r():this[y]=r()})("$script",function(){var y=document,r=y.getElementsByTagName("head")[0],j=!1,v="push",c="readyState",m="onreadystatechange",u={},g={},h={},w,x;function _(e,n){for(var t=0,l=e.length;t<l;++t)if(!n(e[t]))return j;return 1}function a(e,n){_(e,function(t){return n(t),1})}function o(e,n,t){e=e[v]?e:[e];var l=n&&n.call,i=l?n:t,U=l?e.join(""):n,L=e.length;function M(d){return d.call?d():u[d]}function E(){if(!--L){u[U]=1,i&&i();for(var d in g)_(d.split("|"),M)&&!a(g[d],M)&&(g[d]=[])}}return setTimeout(function(){a(e,function d(s,N){if(s===null)return E();if(!N&&!/^https?:\/\//.test(s)&&w&&(s=s.indexOf(".js")===-1?w+s+".js":w+s),h[s])return h[s]==2?E():setTimeout(function(){d(s,!0)},0);h[s]=1,p(s,E)})},0),o}function p(e,n){var t=y.createElement("script"),l;t.onload=t.onerror=t[m]=function(){t[c]&&!/^c|loade/.test(t[c])||l||(t.onload=t[m]=null,l=1,h[e]=2,n())},t.async=1,t.src=x?e+(e.indexOf("?")===-1?"?":"&")+x:e,r.insertBefore(t,r.lastChild)}return o.get=p,o.order=function(e,n,t){(function l(i){i=e.shift(),e.length?o(i,l):o(i,n,t)})()},o.path=function(e){w=e},o.urlArgs=function(e){x=e},o.ready=function(e,n,t){e=e[v]?e:[e];var l=[];return!a(e,function(i){u[i]||l[v](i)})&&_(e,function(i){return u[i]})?n():function(i){g[i]=g[i]||[],g[i][v](n),t&&t(l)}(e.join("|")),o},o.done=function(e){o([null],e)},o})})(F);var Q=F.exports;const W=q(Q),I=f=>(O("data-v-0a6a3184"),f=f(),G(),f),X={style:{height:"100%",width:"100%"}},Y=I(()=>T("link",{rel:"stylesheet",href:"/static/editor.md/css/editormd.css"},null,-1)),Z=I(()=>T("div",{id:"editor",style:{"z-index":"10"}},null,-1)),ee={class:"dialog-footer"},te=R({__name:"Editor",props:{height:{type:String,required:!1,default:"100vh"}},setup(f){const r=D().query,j=f;let v=S(""),c=null;const m=S(!1),u=S(""),g=async()=>{await _("/static/editor.md/lib/jquery.js"),await _("/static/editor.md/editormd.js"),await H();var a=v.value;c=window.editormd("editor",{path:"/static/editor.md/lib/",height:j.height,width:"100%",emoji:!1,imageUpload:!0,saveHTMLToTextarea:!0,theme:localStorage.theme?localStorage.theme:"dark",editorTheme:localStorage.editorTheme?localStorage.editorTheme:"3024-night",previewTheme:localStorage.previewTheme?localStorage.previewTheme:"default",imageFormats:["jpg","jpeg","gif","png","bmp","webp","ico"],imageUploadURL:"/api/uploads/images",htmlDecode:!0,change:function(){console.log("监听更新，更新父组件值 change:",c.getMarkdown())},onfullscreen:function(){var o=document.getElementById("editor");o.style["z-index"]=13},onfullscreenExit:function(){var o=document.getElementById("editor");o.style["z-index"]=10},onload:function(){this.setMarkdown(a)}}),c.on("change",function(){console.log("监听，改变父组件的值 change:",c.getMarkdown())}),$("#get-html-btn").bind("click",function(){alert(c.getHTML())})},h=()=>{m.value=!0},w=()=>{B.post("/api/saveFile/markdown",{title:u.value,content:c.getMarkdown()}).then(a=>{console.log(a),a.data.success==1&&(m.value=!1,J("保存成功"))})},x=()=>{const a=c.getMarkdown(),o=u.value,p=document.createElement("a"),e=new Blob([a],{type:"text/markdown;charset=utf-8"});p.href=URL.createObjectURL(e),p.download=`${o}.md`,p.click()};function _(a){return new Promise(o=>{W(a,()=>{o()})})}return z(()=>{setTimeout(async()=>{if(r&&r.title){const a=await B.post("/api/readFile/markdown",{title:r.title});console.log("res:",a.data),v.value=a.data.data,typeof r.title=="string"&&(u.value=r.title.split(".")[0])}g()},300)}),(a,o)=>{const p=C("el-input"),e=C("el-button"),n=C("el-dialog");return P(),A("div",X,[Y,T("button",{id:"get-md-btn",style:{float:"right"},onClick:h}," 保存文件 "),Z,k(n,{modelValue:m.value,"onUpdate:modelValue":o[2]||(o[2]=t=>m.value=t),title:"请输入文件名称",width:"500"},{footer:b(()=>[T("div",ee,[k(e,{onClick:o[1]||(o[1]=t=>m.value=!1)},{default:b(()=>[V("Cancel")]),_:1}),k(e,{type:"primary",onClick:x},{default:b(()=>[V(" 保存到本地 ")]),_:1}),k(e,{type:"primary",onClick:w},{default:b(()=>[V(" 保存服务器 ")]),_:1})])]),default:b(()=>[k(p,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=t=>u.value=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["modelValue"])])}}}),ne=K(te,[["__scopeId","data-v-0a6a3184"]]);export{ne as default};
